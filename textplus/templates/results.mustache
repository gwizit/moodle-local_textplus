{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template local_textplus/results

    Results page template for the TextPlus plugin.

    Context variables required for this template:
    * title - Results page title
    * scan_only - Boolean indicating preview mode
    * preview_warning - Warning message for preview mode (if scan_only)
    * stats - Array of stat cards
    * no_items_replaced - Boolean if no items were replaced
    * no_items_message - Message when no items replaced
    * database_items - Array of successfully replaced database items
    * has_output - Boolean if processing output exists
    * output_lines - Array of processing output lines
    * completion_message - Completion message
    * completion_class - CSS class for completion message (alert-success, alert-info)
    * donation_message - Donation message
    * startover_url - URL for start over button

    Example context (json):
    {
        "title": "Results",
        "scan_only": true,
        "preview_warning": "Preview mode - no changes made",
        "stats": [
            {"number": 5, "label": "Items found"}
        ],
        "database_items": [
            {
                "table_name": "course",
                "field_name": "summary",
                "record_id": 123,
                "message": "Would be replaced",
                "has_preview": true,
                "preview_text": "Sample text..."
            }
        ],
        "startover_url": "/local/textplus/index.php"
    }
}}

<div class="local-textplus-results">
    <h2>{{title}}</h2>

    {{#scan_only}}
    <div class="local-textplus-preview-warning">
        {{{preview_warning}}}
    </div>
    {{/scan_only}}

    {{#stats}}
    <div class="local-textplus-stats-container">
        {{#stats}}
        <div class="local-textplus-stat-card">
            <div class="local-textplus-stat-number">{{number}}</div>
            <div class="local-textplus-stat-label">{{label}}</div>
        </div>
        {{/stats}}
    </div>
    {{/stats}}

    {{#no_items_replaced}}
    <div class="alert alert-warning">
        {{{no_items_message}}}
    </div>
    {{/no_items_replaced}}

    {{#database_items}}
    <div class="local-textplus-section-header">{{database_header}}</div>
    <div class="local-textplus-item-list">
        {{#database_items}}
        <div class="local-textplus-item-result">
            <div class="local-textplus-item-header">
                <strong>{{table_name}}</strong> â†’ {{field_name}} (ID: {{record_id}})
            </div>
            <div class="local-textplus-item-message {{message_class}}">{{message}}</div>
            {{#has_preview}}
            <div class="local-textplus-item-preview">
                <strong>{{preview_label}}:</strong>
                <div class="local-textplus-preview-content">{{preview_text}}</div>
            </div>
            {{/has_preview}}
        </div>
        {{/database_items}}
    </div>
    {{/database_items}}

    {{#has_output}}
    <h3>{{output_title}}</h3>
    <div class="local-textplus-output-console">
        {{#output_lines}}
        <div class="local-textplus-output-line local-textplus-output-{{type}}">{{message}}</div>
        {{/output_lines}}
    </div>
    {{/has_output}}

    {{#completion_message}}
    <div class="alert {{completion_class}}">
        {{{completion_message}}}
    </div>
    {{/completion_message}}

    {{#donation_message}}
    <div class="alert alert-warning text-center">
        {{{donation_message}}}
    </div>
    {{/donation_message}}

    <div class="mt-3">
        <a href="{{startover_url}}" class="btn btn-primary">{{startover_label}}</a>
    </div>
</div>
